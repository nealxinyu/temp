"use strict";function _slicedToArray(e,r){return _arrayWithHoles(e)||_iterableToArrayLimit(e,r)||_unsupportedIterableToArray(e,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,n,o=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(a=t.next()).done)&&(o.push(a.value),!r||o.length!==r);i=!0);}catch(e){l=!0,n=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw n}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return o=e.done,e},e:function(e){i=!0,n=e},f:function(){try{o||null==t.return||t.return()}finally{if(i)throw n}}}}function _unsupportedIterableToArray(e,r){if(e){if("string"==typeof e)return _arrayLikeToArray(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(t="Object"===t&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,r):void 0}}function _arrayLikeToArray(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}$("span[type=filter-badge-role],span[type=filter-badge-stream]").on("click",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected"),updateBarChart()}),$("span[type=filter-badge-skill]").on("click",function(){$("span[type=filter-badge-skill]").removeClass("selected"),$(this).addClass("selected"),$("#modal-filter-2").modal("hide"),updatePieChart()}),$("#filter-search-input").on("input",function(){var e=$(this).val();searchKeyword(e)});var getSlectedOptions=function(e){var r=[];return $("span[type="+e+"].selected").each(function(){r.push($(this).text())}),r},updateBarChart=function(){var e=getSlectedOptions("filter-badge-role"),t=getSlectedOptions("filter-badge-stream"),a=[];if(0==e.length&&0==t.length)a=rawdata;else if(0==t.length)Object.values(rawdata).forEach(function(r){e.some(function(e){return e.toLowerCase()==r.role.toLowerCase()})&&a.push(r)});else if(0==e.length)Object.values(rawdata).forEach(function(r){t.some(function(e){return e.toLowerCase()==r.stream.toLowerCase()})&&a.push(r)});else{var n=[];Object.values(rawdata).forEach(function(r){e.some(function(e){return e.toLowerCase()==r.role.toLowerCase()})&&n.push(r)});for(var o=0,i=n;o<i.length;o++)!function(){var r=i[o];t.some(function(e){return e.toLowerCase()==r.stream.toLowerCase()})&&a.push(r)}()}var r,l=[],s=[],c=_createForOfIteratorHelper(getAllSkill(a));try{for(c.s();!(r=c.n()).done;){var d=r.value;l.push(d[0]),s.push(d[1])}}catch(e){c.e(e)}finally{c.f()}barChart.setOption({xAxis:{data:l.slice(0,20)},series:[{data:s.slice(0,20)}]})},updatePieChart=function(){var e=getSlectedOptions("filter-badge-skill");if(e.length){var r,t=e[0],a=getAllRole(rawdata),e=getAllStream(rawdata),n={},o=_createForOfIteratorHelper(a);try{for(o.s();!(r=o.n()).done;){var i=r.value;n[i[0]]={value:0,name:i[0]}}}catch(e){o.e(e)}finally{o.f()}var l,s={},c=_createForOfIteratorHelper(e);try{for(c.s();!(l=c.n()).done;){var d=l.value;s[d[0]]={value:0,name:d[0]}}}catch(e){c.e(e)}finally{c.f()}Object.values(rawdata).forEach(function(e){Object.keys(e.skills).some(function(e){return e.toLowerCase()==t.toLowerCase()})&&(s[e.stream].value+=1,n[e.role].value+=1)});var u,f=[],p=[];for(u in n)f.push(n[u]);for(u in s)p.push(s[u]);pieChartRole.setOption({series:[{data:f}]}),pieChartStream.setOption({series:[{data:p}]})}},initCharts=function(){addModalSettingOptionToChart(barChart,"#modal-filter-1"),addModalSettingOptionToChart(pieChartRole,"#modal-filter-2"),addModalSettingOptionToChart(pieChartStream,"#modal-filter-2"),updateBarChart(),$("span[type=filter-badge-skill]").first().click()};function addModalSettingOptionToChart(e,r){e.setOption({toolbox:{feature:{mySetting:{show:!0,icon:"path://M22.2,14.4L21,13.7c-1.3-0.8-1.3-2.7,0-3.5l1.2-0.7c1-0.6,1.3-1.8,0.7-2.7l-1-1.7c-0.6-1-1.8-1.3-2.7-0.7   L18,5.1c-1.3,0.8-3-0.2-3-1.7V2c0-1.1-0.9-2-2-2h-2C9.9,0,9,0.9,9,2v1.3c0,1.5-1.7,2.5-3,1.7L4.8,4.4c-1-0.6-2.2-0.2-2.7,0.7   l-1,1.7C0.6,7.8,0.9,9,1.8,9.6L3,10.3C4.3,11,4.3,13,3,13.7l-1.2,0.7c-1,0.6-1.3,1.8-0.7,2.7l1,1.7c0.6,1,1.8,1.3,2.7,0.7L6,18.9   c1.3-0.8,3,0.2,3,1.7V22c0,1.1,0.9,2,2,2h2c1.1,0,2-0.9,2-2v-1.3c0-1.5,1.7-2.5,3-1.7l1.2,0.7c1,0.6,2.2,0.2,2.7-0.7l1-1.7   C23.4,16.2,23.1,15,22.2,14.4z M12,16c-2.2,0-4-1.8-4-4c0-2.2,1.8-4,4-4s4,1.8,4,4C16,14.2,14.2,16,12,16z",onclick:function(){return $(r).modal()}}}}})}function getAllSkill(e){return res=[],Object.values(e).forEach(function(e){e=Object.keys(e.skills);res=res.concat(e)}),res=sortByFrequencyAndRemoveDuplicates(res,isToUpperCase=!0),res}function getAllRole(e){return res=[],Object.values(e).forEach(function(e){return res=res.concat(e.role)}),res=sortByFrequencyAndRemoveDuplicates(res,isToUpperCase=!1),res}function getAllStream(e){return res=[],Object.values(e).forEach(function(e){return res=res.concat(e.stream)}),res=sortByFrequencyAndRemoveDuplicates(res,isToUpperCase=!1),res}function sortByFrequencyAndRemoveDuplicates(e,r){for(var t,a={},n=0;n<e.length;n++)(t=r?e[n].toUpperCase():e[n])in a?a[t]++:a[t]=1;var o=[];for(t in a)o.push(t);for(var o=o.sort(function(e,r){return a[r]-a[e]}),i=[],l=0;l<o.length;l++)i.push([o[l],a[o[l]]]);return i}initCharts();var updateSummary=function(e){$("#summary-result-count").text(e.result.length),$("#summary-selected-options").empty();var r,t=_createForOfIteratorHelper(e.selectedRoles);try{for(t.s();!(r=t.n()).done;){var a=r.value;$("#summary-selected-options").append("<span class='badge badge-pill badge-person-info badge-md badge-warning badge-no-text-transform m-1'>"+a+"</span>")}}catch(e){t.e(e)}finally{t.f()}var n,o=_createForOfIteratorHelper(e.selectedStreams);try{for(o.s();!(n=o.n()).done;){var i=n.value;$("#summary-selected-options").append("<span class='badge badge-pill badge badge-pill badge-person-info badge-md badge-info badge-no-text-transform m-1'>"+i+"</span>")}}catch(e){o.e(e)}finally{o.f()}var l,s=_createForOfIteratorHelper(e.selectedSkills);try{for(s.s();!(l=s.n()).done;){var c=l.value;$("#summary-selected-options").append("<span class='badge badge-md badge-secondary m-1'>"+c+"</span>")}}catch(e){s.e(e)}finally{s.f()}},filter_person_card_by_slected_options=function(e,t,r){return e.filter(function(){return isContain=!1,$(this).find(r).each(function(){var r=this;t.some(function(e){return e.toLowerCase()==$(r).text().toLowerCase()})&&(isContain=!0)}),isContain})},searchKeyword=function(e){$("span[type=filter-badge-skill]").removeClass("d-none"),$("span[type=filter-badge-skill]").each(function(){-1==$(this).text().toLowerCase().search(e.toLowerCase())&&$(this).addClass("d-none")})};skillPriorityBarChart.on("click",function(e){var r="#modal-bar-detail";updateBarDetailModal(r,e.seriesName,e.name).length&&$(r).modal()});var sortByPriority=function(){skillPriorityBarChart.setOption({legend:{selected:{Fresh:!0,Junior:!0,Proficient:!0,Master:!0}}}),updateSkillPriorityBarChart("priority",!0)},sortBy=0,sortByParams=function(){var e=["Fresh","Junior","Proficient","Master"][sortBy++%4];updateSkillPriorityBarChart(e);var r={Fresh:!1,Junior:!1,Proficient:!1,Master:!1};r[e]=!0,skillPriorityBarChart.setOption({legend:{selected:r}})},updateBarDetailModal=function(e,r,t){var a=getProficiencyNumber(r),n=Object.values(rawdata).filter(function(e){return a==e.skills[t]});return $(e+" #modal-bar-detail-title").html("".concat(n.length,' <span style="color:red">').concat(r,'</span> in <span style="color:red">').concat(t,"</span>")),$(e+" .row").html(getPersonCardHtml(n)),$("span[type=modal-card-person-skill]").each(function(){$(this).text().toLowerCase()==t.toLowerCase()&&$(this).addClass("skill-highlight")}),n},getPersonCardHtml=function(e){var r,t="",a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var n,o,i,l,s=r.value;if(t+='\n        <div type="modal-card-person" class="col-sm-12 col-lg-4 col-xl-4">\n            <div class="card my-2 d-flex flex-grow-1 border-0">\n                <div class="card-body">\n                    <h4 class="mb-0">'.concat(s.name,'</h4>\n                    <div class="mb-4">\n                        <p class="text-muted mb-0">').concat(s.id,"</p>\n                    </div>\n        "),null!=s&&null!==(n=s.proficiency)&&void 0!==n&&n.expert){var c,d=_createForOfIteratorHelper(s.proficiency.expert);try{for(d.s();!(c=d.n()).done;){var u=c.value;t+='\n<span type="modal-card-person-skill" class="badge badge-md badge-default my-1">'.concat(u,"</span>")}}catch(e){d.e(e)}finally{d.f()}}if(null!=s&&null!==(o=s.proficiency)&&void 0!==o&&o.proficient){var f,p=_createForOfIteratorHelper(s.proficiency.proficient);try{for(p.s();!(f=p.n()).done;){var y=f.value;t+='\n<span type="modal-card-person-skill" class="badge badge-md badge-info my-1">'.concat(y,"</span>")}}catch(e){p.e(e)}finally{p.f()}}if(null!=s&&null!==(i=s.proficiency)&&void 0!==i&&i.junior){var h,v=_createForOfIteratorHelper(s.proficiency.junior);try{for(v.s();!(h=v.n()).done;){var m=h.value;t+='\n<span type="modal-card-person-skill" class="badge badge-md badge-secondary my-1">'.concat(m,"</span>")}}catch(e){v.e(e)}finally{v.f()}}if(null!=s&&null!==(l=s.proficiency)&&void 0!==l&&l.fresh){var b,g=_createForOfIteratorHelper(s.proficiency.fresh);try{for(g.s();!(b=g.n()).done;){var C=b.value;t+='\n<span type="modal-card-person-skill" class="badge badge-md badge-secondary opacity-50 my-1">'.concat(C,"</span>")}}catch(e){g.e(e)}finally{g.f()}}t+="\n                </div>\n            </div>\n        </div>\n        "}}catch(e){a.e(e)}finally{a.f()}return t},getProficiencyNumber=function(e){return{Fresh:0,Junior:1,Proficient:2,Master:3}[e]},addSkillPriorityToDict=function(e){var r,t=departmentSkills;for(r in e){var a=t[r];e[r].priority=void 0===a?999:a}return e},updateSkillPriorityBarChart=function(t){var a=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=getSkillsCount(rawdata),n=addSkillPriorityToDict(n);skills=Object.keys(n),t&&(skills=Object.keys(n).sort(function(e,r){return a?n[e][t]-n[r][t]:n[r][t]-n[e][t]}));var e=getDataForStackedBarChart(n,skills);skillPriorityBarChart.setOption({xAxis:{data:skills},series:[{name:"Fresh",data:e.Fresh},{name:"Junior",data:e.Junior},{name:"Proficient",data:e.Proficient},{name:"Master",data:e.Master},{name:"Proficiency Index",data:e["Proficiency Index"]}]})};function getSkillsCount(e){var r,o={},t=_createForOfIteratorHelper(departmentSkills);try{for(t.s();!(r=t.n()).done;){var a=r.value;o[a]={Fresh:0,Junior:0,Proficient:0,Master:0}}}catch(e){t.e(e)}finally{t.f()}return Object.values(e).forEach(function(e){for(var r=0,t=Object.entries(e.skills);r<t.length;r++){var a=_slicedToArray(t[r],2),n=a[0],a=a[1];if(n in o)switch(a){case 0:o[n].Fresh+=1;break;case 1:o[n].Junior+=1;break;case 2:o[n].Proficient+=1;break;case 3:o[n].Master+=1}}}),o}function getDataForStackedBarChart(e,r){var t,a={Fresh:[],Junior:[],Proficient:[],Master:[],"Proficiency Index":[]},n=_createForOfIteratorHelper(r);try{for(n.s();!(t=n.n()).done;){var o=t.value;a.Fresh.push(e[o].Fresh),a.Junior.push(e[o].Junior),a.Proficient.push(e[o].Proficient),a.Master.push(e[o].Master)}}catch(e){n.e(e)}finally{n.f()}return a["Proficiency Index"]=getProficiencyIndex(a),a}function getProficiencyIndex(e){for(var r=[],t=0;t<e.Fresh.length;t++){var a=Math.round(0*e.Fresh[t]+.34*e.Junior[t]+.67*e.Proficient[t]+ +e.Master[t]);r.push(a)}return r}var initSkillPriorityChart=function(){skillPriorityBarChart.setOption({toolbox:{feature:{mySortByParams:{show:!0,icon:"path://M0 11.5a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2zm4-3a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-5zm4-3a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-8zm4-3a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 .5.5v11a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-11z",onclick:sortByParams},mySortByPriority:{show:!0,icon:"path://M2.5 2v6h6M2.66 15.57a10 10 0 1 0 .57-8.38",onclick:sortByPriority}}}}),updateSkillPriorityBarChart("priority",!0)};initSkillPriorityChart();